{"version":3,"sources":["webpack:///./src/views/management/system/menu/index.vue","webpack:///./src/views/management/system/menu/index.vue?c742","webpack:///./src/views/management/system/menu/index.vue?1923"],"names":["panelProps","asideProps","width","style","title","ref","class","data","menuTree","props","accordion","highlight-current","expand-on-click-node","node-key","mainProps","formProps","label","prop","model","name","code","url","orderIndex","isReadonly","type","save","cancelSave","computed","editModel","selNode","toolbar","text","on","onClick","proxyOperation","addCurrent","key","deleteCurrent","modifyCurrent","hidden","this","FormInit","rules","required","message","trigger","methods","menuId","done","Array","prototype","shift","apply","$confirm","confirmButtonText","cancelButtonText","$refs","remove","clickTree","node","isNewNode","Object","keys","forEach","appendNode","nodeData","getCurrentNode","getNode","append","insertChild","parent","$nextTick","setCurrentKey","childNodes","length","expand","lastNode","insertAfter","id","currentNode","Date","getTime","parentId","accessList","$store","commit","params","watch","render"],"mappings":"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","file":"js/chunk-6d1cc94a.362e9b0b.js","sourcesContent":["<template>\n  <m-layout-page>\n    <m-panel-group>\n      <m-panel :panelProps=\"asideProps\" width=\"200px\" style=\"margin-right: 0\" title=\"菜单树\">\n        <el-tree\n          ref=\"menuTree\"\n          class=\"menu-tree\"\n          :data=\"menuTree\"\n          :props=\"{ children: 'children', label: 'name' }\"\n          :accordion=\"true\"\n          :highlight-current=\"true\"\n          :expand-on-click-node=\"true\"\n          node-key=\"menuId\"\n          @node-click=\"\n            (data, node) => {\n              proxyOperation(clickTree, data, node)\n            }\n          \"\n        ></el-tree>\n      </m-panel>\n      <m-panel :panelProps=\"mainProps\" class=\"panel-right\" title=\"菜单详情\">\n        <m-form v-bind:formProps=\"formProps\" ref=\"form\">\n          <m-form-item label=\"菜单名称\" prop=\"name\">\n            <el-input v-model=\"formProps.model.name\"></el-input>\n          </m-form-item>\n          <m-form-item label=\"菜单编码\" prop=\"code\">\n            <el-input v-model=\"formProps.model.code\"></el-input>\n          </m-form-item>\n          <m-form-item label=\"访问地址\" prop=\"url\">\n            <el-input v-model=\"formProps.model.url\"></el-input>\n          </m-form-item>\n          <m-form-item label=\"顺序\" prop=\"orderIndex\">\n            <el-input v-model=\"formProps.model.orderIndex\"></el-input>\n          </m-form-item>\n          <m-form-item v-if=\"!formProps.isReadonly\">\n            <el-button type=\"primary\" @click=\"save\">保存</el-button>\n            <el-button @click=\"cancelSave\">取消</el-button>\n          </m-form-item>\n        </m-form>\n      </m-panel>\n    </m-panel-group>\n  </m-layout-page>\n</template>\n\n<script>\nimport { mapGetters, mapState } from \"vuex\"\nimport req from \"@/api/management/system\"\n\nexport default {\n  name: \"menuManagement\",\n  computed: {\n    ...mapGetters(\"managementAccess\", [\"menuTree\"]),\n    ...mapState(\"managementAccess\", [\"accessList\"]),\n  },\n  data() {\n    return {\n      editModel: \"\",\n      selNode: null,\n      asideProps: {\n        toolbar: [\n          () => ({\n            text: \"新增\",\n            on: {\n              onClick: () => this.proxyOperation(this.addCurrent),\n            },\n            key: \"SYS_MENU_ADD\",\n          }),\n          () => ({\n            text: \"删除\",\n            on: {\n              onClick: () => this.proxyOperation(this.deleteCurrent),\n            },\n            key: \"SYS_MENU_DELETE\",\n          }),\n        ],\n      },\n      mainProps: {\n        toolbar: [\n          () => ({\n            text: \"编辑\",\n            on: {\n              onClick: () => this.proxyOperation(this.modifyCurrent),\n            },\n            props: {\n              hidden: !!this.editModel || !this.selNode,\n            },\n            key: \"SYS_MENU_EDIT\",\n          }),\n        ],\n      },\n      formProps: {\n        isReadonly: true,\n        model: this.FormInit(),\n        rules: {\n          name: [{ required: true, message: \"不能为空\", trigger: \"blur\" }],\n          code: [{ required: true, message: \"不能为空\", trigger: \"blur\" }],\n          url: [{ required: true, message: \"不能为空\", trigger: \"blur\" }],\n          orderIndex: [{ required: true, message: \"不能为空\", trigger: \"blur\" }],\n        },\n      },\n    }\n  },\n  methods: {\n    FormInit() {\n      return {\n        menuId: \"\",\n        name: \"\",\n        code: \"\",\n        url: \"\",\n        orderIndex: \"\",\n      }\n    },\n    async proxyOperation(done) {\n      Array.prototype.shift.apply(arguments)\n      if (this.editModel) {\n        await this.$confirm(\"该操作将不保存已填写的表单数据\", \"提示\", {\n          confirmButtonText: \"确认\",\n          cancelButtonText: \"取消\",\n          type: \"warning\",\n        })\n        this.$refs.menuTree.remove(this.formProps.model.menuId)\n        this.editModel = \"\"\n        this.formProps.model = this.FormInit()\n      }\n      done(...arguments)\n    },\n    clickTree(data, node) {\n      if (this.isNewNode(data)) return\n      this.selNode = node\n      Object.keys(this.formProps.model).forEach((key) => {\n        this.formProps.model[key] = data[key]\n      })\n      this.formProps.model.menuId = node.data.menuId\n    },\n    appendNode(data) {\n      const nodeData = this.$refs.menuTree.getCurrentNode()\n      const node = this.$refs.menuTree.getNode(nodeData)\n      const append = () => {\n        node.insertChild({\n          data,\n          parent: node,\n        })\n        this.$nextTick(() => {\n          this.$refs.menuTree.setCurrentKey(data.menuId)\n        })\n      }\n\n      if (!node) {\n        const lastNode = this.$refs.menuTree.getNode(this.menuTree[this.menuTree.length - 1])\n        this.$refs.menuTree.insertAfter(data, lastNode)\n        this.$nextTick(() => {\n          this.$refs.menuTree.setCurrentKey(data.menuId)\n        })\n      } else if (node.childNodes.length) {\n        append()\n      } else {\n        node.expand(() => {\n          append()\n        })\n      }\n    },\n    isNewNode(data) {\n      return data.id > 15e11\n    },\n    addCurrent() {\n      const currentNode = this.$refs.menuTree.getCurrentNode()\n      this.editModel = \"add\"\n      this.formProps.model = this.FormInit()\n      this.formProps.model.menuId = new Date().getTime()\n      this.formProps.model.parentId = currentNode ? currentNode.menuId : \"\"\n      this.formProps.model.name = \"新建菜单\"\n      this.appendNode(this.formProps.model)\n    },\n    modifyCurrent() {\n      this.editModel = \"modify\"\n    },\n    async deleteCurrent() {\n      await req(\"deleteMenu\", {\n        menuId: this.formProps.model.menuId,\n      })\n      const accessList = await req(\"getMenuList\")\n      this.$store.commit(\"managementAccess/ACCESS_LIST\", accessList)\n      this.selNode = null\n      this.$refs.menuTree.setCurrentKey(null)\n    },\n    async save() {\n      const params = { ...this.formProps.model }\n      if (this.editModel === \"add\") {\n        delete params.menuId\n      }\n      const menuId = await req(`${this.editModel}Menu`, params)\n      const accessList = await req(\"getMenuList\")\n      this.$store.commit(\"managementAccess/ACCESS_LIST\", accessList)\n      if (this.editModel === \"add\") {\n        this.formProps.model.menuId = menuId\n      }\n      this.$nextTick(() => {\n        this.$refs.menuTree.setCurrentKey(this.formProps.model.menuId)\n      })\n      this.editModel = \"\"\n    },\n    cancelSave() {\n      this.selNode = null\n      this.$refs.menuTree.setCurrentKey(null)\n      if (this.editModel === \"add\") {\n        this.$refs.menuTree.remove(this.formProps.model.menuId)\n      }\n      this.editModel = \"\"\n      this.formProps.model = this.FormInit()\n    },\n  },\n  watch: {\n    editModel(type) {\n      this.formProps.isReadonly = !type\n    },\n  },\n}\n</script>\n\n<style lang=\"scss\">\n.panel-right {\n  flex: 1;\n  margin-left: 0;\n  border-left: solid 1px #e8e8e8;\n}\n</style>\n","import { render } from \"./index.vue?vue&type=template&id=08a48e98\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=08a48e98&lang=scss\"\nscript.render = render\n\nexport default script","export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./index.vue?vue&type=style&index=0&id=08a48e98&lang=scss\""],"sourceRoot":""}